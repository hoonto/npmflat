#!/usr/bin/env node

var path = require("path"),
    npmflat = require(path.join(__dirname, '..', '/lib/npmflat'));

var currentWD = process.cwd();
var packagePath = currentWD + '/package.json';
var packageJSON = '';

try {
    packageJSON = require(packagePath);
}catch(e){}

if (process.argv[2] === '--help' || !packageJSON) {
    process.stderr.write([
        "       _      .  ___ ",
        " |\\ | |_ |   /_\\  |  ",
        " | \\| |  |_ /   \\ |  ",
    ].join('\n')+'\n\n'+" Usage: "+path.basename(process.argv[1])+" [,schema.txt]\n Must be executed within a directory that contains a 'package.json' file.\n");
    process.exit(1);
} else {
    npmflat.packageBuilder.build(currentWD, packagePath,process.argv[2]);
}
